<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" name="viewport">
  <meta name="keywords" content="移动端">
  <title>Mobile 布局</title>
  <style type="text/css">
    .test {
      display: inline-block;
      background-color: #0f0;
      width: 4rem;
    }
  </style>
</head>
<body>

  <div class="test">
    Hello world
  </div>

  <script type="text/javascript">
    // 视觉图 750px (deviceWidth * dpr)
    // 基准 1rem = 75px
    // rem-unit plugin sublime
    var dpr, rem, scale;
    var docEl = document.documentElement;
    var styleEl = document.createElement('style');
    var metaEl = document.querySelector('meta[name="viewport"]');
    // var deviceWidth = docEl.clientWidth;
    var deviceWidth = window.screen.width;
    // alert('width=' + deviceWidth);
    if (window.orientation !== undefined) {
      deviceWidth = window.screen[window.orientation === 0 ? 'width' : 'height'];
    }

    dpr = window.devicePixelRatio || 1;
    scale = 1 / dpr;
    rem = deviceWidth * dpr / 10;

    // 设置viewport，进行缩放，达到高清效果
    metaEl.setAttribute('content', 'width=' + dpr * deviceWidth +
      ',initial-scale=' + scale +
      ',maximum-scale=' + scale +
      ',minimum-scale=' + scale +
      ',user-scalable=no'
    );

    // 设置data-dpr属性，留作的css hack之用
    docEl.setAttribute('data-dpr', dpr);

    // 动态写入样式
    docEl.firstElementChild.appendChild(styleEl);
    styleEl.innerHTML = 'html{font-size:' + rem + 'px!important;}';

    // 给js调用的，某一dpr下rem和px之间的转换函数
    window.rem2px = function(v) {
        v = parseFloat(v);
        return v * rem;
    };
    window.px2rem = function(v) {
        v = parseFloat(v);
        return v / rem;
    };
    window.dpr = dpr;
    window.rem = rem;
  </script>
</body>

</html>
